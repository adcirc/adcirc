<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.4.4" />
<title>The ADCIRC Developers Guide</title>
<style type="text/css">
/* Debug borders */
p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
/*
  border: 1px solid red;
*/
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

tt {
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  font-family: sans-serif;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}

div.sectionbody {
  font-family: serif;
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revision {
  font-family: sans-serif;
}

div#footer {
  font-family: sans-serif;
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.5em;
  margin-bottom: 2.5em;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock {
  padding-left: 2.0em;
  margin-right: 10%;
}
div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock {
  padding-left: 2.0em;
  margin-right: 10%;
}
div.verseblock > div.content {
  white-space: pre;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 2px solid silver;
}

div.exampleblock > div.content {
  border-left: 2px solid silver;
  padding: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
div.imageblock img { border: 1px solid silver; }
span.image img { border-style: none; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead {
  font-family: sans-serif;
  font-weight: bold;
}
tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

@media print {
  div#footer-badges { display: none; }
}

div#toctitle {
  color: #527bbd;
  font-family: sans-serif;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}
/* Workarounds for IE6's broken and incomplete CSS2. */

div.sidebar-content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}
div.sidebar-title, div.image-title {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  margin-top: 0.0em;
  margin-bottom: 0.5em;
}

div.listingblock div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock-attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock-content {
  white-space: pre;
}
div.verseblock-attribution {
  padding-top: 0.75em;
  text-align: left;
}

div.exampleblock-content {
  border-left: 2px solid silver;
  padding-left: 0.5em;
}

/* IE6 sets dynamically generated links as visited. */
div#toc a:visited { color: blue; }
</style>
</head>
<body>
<div id="header">
<h1>The ADCIRC Developers Guide</h1>
</div>
<div id="preamble">
<div class="sectionbody">
</div>
</div>
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>This document describes the guidelines that ADCIRC developers should use
when developing new code for ADCIRC and its related utilities. It also
presents a short tutorial for Subversion (svn), the version control software
that we use to coordinate development and ease the task of merging in new
features.</p></div>
</div>
<h2 id="_development_strategy">Development Strategy</h2>
<div class="sectionbody">
<div class="paragraph"><p>The ADCIRC development strategy consists of the maintenance of two separate
versions at any given time: the stable version and the development version. The
stable version only receives bug fixes, while the development version receives
bug fixes as well as new features.</p></div>
<div class="paragraph"><p>At some point, the development version becomes stable. At that time, a stable
branch is created from it, and then new features are added to the previosly
stable code, creating a new development version. At that time, the major
version number will be incremented, e.g., stable v48.xx will become the next
development version as v49.00.</p></div>
<div class="paragraph"><p>The minor version number is changed each time there is a change
in the code and the modified code is committed back to the repository. Details
of the implementation of this strategy with Subversion are provided in
the section entitled "Subversion".</p></div>
</div>
<h2 id="_coding_standards">Coding Standards</h2>
<div class="sectionbody">
<div class="paragraph"><p>ADCIRC has had many individual contributors and has received code accretions
over many years. A set of uniform coding standards has not been defined, and as
a result, ADCIRC contains many different styles of Fortran. This section
provides a set of style guidelines for contributing code to ADCIRC.</p></div>
<h3 id="_the_basics">The Basics</h3><div style="clear:left"></div>
<div class="ulist"><ul>
<li>
<p>
IMPLICIT NONE at the beginning of each subroutine.
</p>
</li>
<li>
<p>
Fixed form, never exceeding the 72 column limit, even for comment lines.
</p>
</li>
<li>
<p>
When adding code to an existing subroutine, make the new code match the style of the surrounding code, even if you&#8217;d prefer another style.
</p>
</li>
</ul></div>
<h3 id="_maintainability">Maintainability</h3><div style="clear:left"></div>
<div class="paragraph"><p>When adding code that will be used in slightly different ways in different
contexts, make it a subroutine, rather than cutting and pasting several times
and making small changes to each cut-and-pasted section. Although it is faster
to write code with cut-and-paste, the resulting code is harder to maintain,
since each cut-and-pasted section will have to be modified individually later.
Also, it is easier to make mistakes when working with cut-and-pasted code.</p></div>
<div class="paragraph"><p>Rick has expressed a desire for greater modularity &#8230; particularly with the
number of variables in the global module. When adding a major new feature,
please consider the modularity of the data it requires. In other words, if new
variables can be made private to a particular module rather than global, please
do so.</p></div>
</div>
<h2 id="_release_process">Release Process</h2>
<div class="sectionbody">
<div class="paragraph"><p>The release process informal, but generally includes the following steps:</p></div>
<div class="ulist"><ul>
<li>
<p>
Set and stick to a list of new features as the goal for the new release.
</p>
</li>
<li>
<p>
Have a consensus among ADCIRC developers that the goal has been achieved.
</p>
</li>
<li>
<p>
Run tests that cover the new features as well as making sure old features still work.
</p>
</li>
<li>
<p>
Fix issues revealed by failed tests.
</p>
</li>
<li>
<p>
Distribute the release candidate code to collaborative users to make sure their runs perform as expected on the new code.
</p>
</li>
<li>
<p>
Fix issues revealed by user dismay.
</p>
</li>
<li>
<p>
Update the docs to reflect the changes. If input files or file formats have changed, produce release notes to highlight the changes.
</p>
</li>
<li>
<p>
Publicly announce, release, and brag about a shiny new version of ADCIRC.
</p>
</li>
</ul></div>
<div class="paragraph"><p>These tests are often referred to as "regression tests," i.e., a means to
detect a regression in correctness or functionality due to changes in the code.
A regression test suite can be built up pretty easily.  There are a number of
small test cases on adcirc.org, so the initial set of tests should consist of
those. We may also want to differentiate between tests for correctness and
tests for functionality. The former is making sure you&#8217;re getting the expected
model results and the latter is making sure that nothing is broken (i.e.,
adcprep, i/o, message passing, etc).</p></div>
<div class="paragraph"><p>The test suite gets built up based on different purposes.  One may want to
exercise more options and more cases, but it is also important to test for
known bugs that might have been reintroduced.  In otherwords, once a bug is
discovered and fixed, a test should be created specifically for that bug to
make sure it doesn&#8217;t appear again.</p></div>
<div class="paragraph"><p>And lastly, a small test suite should be included with each distribution and a
more comprehensive should be created that runs during development and before a
release. A step in this direction has been made using ant in the autotest
directory.</p></div>
</div>
<h2 id="_subversion">Subversion</h2>
<div class="sectionbody">
<div class="paragraph"><p>Subversion is a version control system. That is, it provides a means for many
software developers to collaborate on a single software project.</p></div>
<div class="paragraph"><p>A subversion repository is a storehouse of code for a particular project.
Subversion repositories consist of a trunk, which is the mainline code that
everyone shares, and any number of branches that are created by and for
individual users.</p></div>
<div class="paragraph"><p>A branch may be created by a developer that has a lot of changes to make over a
longer period of time. This lone developer can work on a branch without
affecting the mainline code. Once the changes in the branch are satisfactory,
the branch can be merged back to the trunk, making the changes available to
all.</p></div>
<div class="paragraph"><p>A further advantage of Subversion is that it automates the process of merging
new features into ADCIRC. For example, in the past, without Subversion,
developers modified their local copies of ADCIRC and wanted to merge the
modifications into the mainline code. This required hours or days of
painstakingly examining each change they had made and cutting and pasting the
changes one by one into the up-to-date version of ADCIRC. With Subversion, the
software examines the changes that were made locally and makes corresponding
changes to the mainline version in an automated way.</p></div>
<h3 id="_policies">Policies</h3><div style="clear:left"></div>
<div class="paragraph"><p>Working with subversion requires greater coordination among ADCIRC developers.
For example, if two developers change the same line of code in two different
branches in two different ways, this will create a conflict that will have to
be resolved manually.</p></div>
<div class="paragraph"><p>Furthermore, if one developer makes changes to trunk that prevent the code from
compiling, it will be difficult for other developers to continue working if
they update to the latest code. As a result, ADCIRC development with Subversion
will adhere to the following policies:</p></div>
<div class="ulist"><ul>
<li>
<p>
Communicate. Jason Fleming is responsible for making sure ADCIRC development is
smooth, pain-free and productive---when in doubt, email him (<a href="mailto:jason.fleming@seahorsecoastal.com">jason.fleming@seahorsecoastal.com</a>).
</p>
</li>
</ul></div>
<div class="paragraph"><p>*Also use the adcirc-dev mailing list to keep everyone informed of what you are doing.
*If you are not on the adcirc-dev mailing list and would like to be, email Jason Fleming.
* Make a branch to develop new features, rather than making changes to trunk.
* Don&#8217;t commit changes to trunk that prevent the code from compiling, at least on your platform. You should also confirm that your code compiles with and without NetCDF.</p></div>
<h3 id="_instructions">Instructions</h3><div style="clear:left"></div>
<div class="paragraph"><p>Comprehensive documentation for Subversion is available: <a href="http://svnbook.red-bean.com/">http://svnbook.red-bean.com/</a>.</p></div>
<div class="paragraph"><p>The ADCIRC code is hosted at the following Subversion repository location:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>https://adcirc.renci.org/svn/adcirc</tt></pre>
</div></div>
<div class="paragraph"><p>To check out code from the trunk, please type</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>svn checkout https://adcirc.renci.org/svn/adcirc/trunk</tt></pre>
</div></div>
<div class="paragraph"><p>Here are a few examples of things that we commonly do with svn.</p></div>
<h4 id="_compare_revisions">Compare Revisions</h4>
<div class="paragraph"><p>In order to see the changes between revisions of the repository, type (for example)</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>svn diff  -r 15:16 owiwind.F</tt></pre>
</div></div>
<h4 id="_package_up_code_from_repository">Package Up Code From Repository</h4>
<div class="paragraph"><p>In order to create a tar file that contains just the ADCIRC code and excludes
the .svn directories, the first step is to export the code to a new
subdirectory. For example:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>svn export ./trunk ./adc99_99</tt></pre>
</div></div>
<div class="paragraph"><p>Would copy the local files under version control from the trunk subdir to the
adc99_99 subdir, excluding the .svn files. Particular revisions of the svn
repository can also be extracted, see the svn documentation for details on how
to do this.</p></div>
<h4 id="_pull_old_version_from_repository">Pull Old Version from Repository</h4>
<div class="paragraph"><p>One advantage of using svn is that it is easy to go back to an older version of
the code, if necessary. The first thing to do in this case is usually to look
at the svn log to see what changes were made, so that you can select the right
version of the repository to extract. Go to the subdirectory of the code tree
that you want an older version of and issue the command</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>svn log</tt></pre>
</div></div>
<div class="paragraph"><p>Look at the log entries, and note the revision that you&#8217;d like to extract.
Let&#8217;s say you want to retrieve adcirc48/trunk at revision 65 of the repository
(for example). Issue the following command:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>svn checkout -r 65 https://adcirc.renci.org/svn/adcirc/trunk</tt></pre>
</div></div>
<h4 id="_make_a_branch">Make a Branch</h4>
<div class="paragraph"><p>To make a branch off trunk to add a new feature and call it the myfeature branch:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>svn copy https://adcirc.renci.org/svn/adcirc/trunk https://adcirc.renci.org/svn/adcirc/branches/myfeature --message "Creating branch to add myfeature"</tt></pre>
</div></div>
<div class="paragraph"><p>Then to start using the newly created branch:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>svn checkout https://adcirc.renci.org/svn/adcirc/branches/myfeature</tt></pre>
</div></div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2011-03-03 11:26:42 EDT
</div>
</div>
</body>
</html>
